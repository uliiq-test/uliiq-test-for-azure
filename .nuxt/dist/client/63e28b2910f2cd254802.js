(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{228:function(t,e,a){var n=a(233);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(20).default)("85925b48",n,!1,{})},230:function(t,e,a){"use strict";a.d(e,"a",function(){return o});var n=function(t,e,a,n){return new(a||(a=Promise))(function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function i(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new a(function(e){e(t.value)}).then(s,i)}c((n=n.apply(t,e||[])).next())})},r=function(t,e){var a,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},o=function(){function t(){this.responseStatuses=new Array}return t.prototype.putError=function(t){this.responseStatuses.push(t)},t.prototype.checkError=function(){for(var t=0,e=this.responseStatuses;t<e.length;t++){var a=e[t];if(!String(a).startsWith("2"))return a}return"200"},t.prototype.procError=function(t,e,a,o){return n(this,void 0,void 0,function(){var n;return r(this,function(r){switch(r.label){case 0:return[4,this.checkError()];case 1:switch(n=r.sent(),String(n)){case"401":return[3,2];case"200":return[3,4]}return[3,5];case 2:return[4,t.dispatch("addNextPagePath",e.fullPath)];case 3:return r.sent(),[2,a("/account/signup")];case 4:return[3,6];case 5:return o({statusCode:n,message:"予期しないエラーが発生しました"}),[2];case 6:return[2]}})})},t}()},231:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"modalThanks",appear:""}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{attrs:{id:"modal-content"}},[a("div",{attrs:{id:"modal-overlay"}}),t._v(" "),a("div",{staticClass:"dialogImg"}),t._v(" "),a("div",{staticClass:"dialogMessage"},[a("div",{staticClass:"bountyList"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.imageUrl,expression:"imageUrl"}],staticClass:"topBaunty"},[a("img",{staticClass:"dialogMessageImg",attrs:{src:t.imageUrl}})])]),t._v(" "),t._l(t.messages,function(e){return a("div",{key:e},[a("p",{domProps:{innerHTML:t._s(t.$options.filters.newLine(e))}})])})],2),t._v(" "),a("div",[a("button",{staticClass:"rewardButton joinButton",attrs:{id:"modal-close"},on:{click:function(e){t.$emit("close")}}},[t._v("閉じる")])])])])])])};n._withStripped=!0;var r,o=a(4),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),i=function(t,e,a,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,n);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(s=(o<3?r(s):o>3?r(e,a,s):r(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s},c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),i([Object(o.Prop)()],e.prototype,"messages",void 0),i([Object(o.Prop)()],e.prototype,"imageUrl",void 0),e=i([Object(o.Component)({})],e)}(o.Vue),l=(a(232),a(6)),u=Object(l.a)(c,n,[],!1,null,null,null);e.a=u.exports},232:function(t,e,a){"use strict";var n=a(228);a.n(n).a},233:function(t,e,a){(t.exports=a(19)(!1)).push([t.i,".modal-mask{position:fixed;z-index:9998;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:table;transition:opacity .3s ease}.modal-mask .modal-wrapper{position:fixed;margin-top:8%;margin-left:25%}@media (max-width:767px){#modal-content{margin:0 auto;position:relative}.modal-mask .modal-wrapper{margin-left:0}}",""])},302:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"mypageTop"},[a("div",{staticClass:"container"},[a("div",{staticClass:"profileArea"},[t.isCreater?a("div",[a("nuxt-link",{staticClass:"textPink",attrs:{to:"/rewards/"+this.$route.params.id}},[a("span",{staticClass:"chatBack"},[t._v("＜")]),t._v("リワードに戻る")])],1):a("div",[a("nuxt-link",{staticClass:"textPink",attrs:{to:"/account/my"}},[a("span",{staticClass:"chatBack"},[t._v("＜")]),t._v("マイページに戻る")])],1),t._v(" "),a("h3",{staticClass:"bountyTitle"},[t._v(t._s(t.reward.rewardName))]),t._v(" "),a("div",{staticClass:"projectData"},[a("p",[t._v("ステータス："+t._s(t.rewardStatsName))])]),t._v(" "),a("div",{staticClass:"projectData"},[a("p",[t._v("交換ポイント："),a("span",[t._v(t._s(t._f("zeroToNone")(t._f("toLocaleString")(t.reward.exchangeRate)))+" "+t._s(t._f("delete")(t.pointName,0==t.reward.exchangeRate||null==t.reward.exchangeRate))+" ")])]),t._v(" "),a("p",[t._v("個数："),a("span",[t._v(t._s(t._f("toLocaleString")(t.reward.ownQuantity))+" / "+t._s(t._f("toLocaleString")(t.reward.quantity)))])])]),t._v(" "),t._m(0)])])]),t._v(" "),a("div",{staticClass:"container rewardChatArea"},[a("div",{staticClass:"activityArea bottomAddChatArea"},[t._l(t.rewardComments,function(e){return a("CardUser",{key:e.rewardCommentId,attrs:{profileImageUrl:e.account.profileImageUrl,displayName:e.account.displayName,date:e.postedDateTime,accountName:e.account.accountName,description:e.comment,commentId:e.rewardCommentId,replyRewardComment:e.replyComment,commentLikeCount:null,commentLikeQuantity:null,dialogProfileImageUrl:e.account.profileImageUrl,canPostComment:e.canPostComment,commentAccountName:e.account.accountName,isRewardChat:!0,commentType:"Reward"},on:{refreshComment:function(e){t.refreshComment()}}})}),t._v(" "),a("div",{staticClass:"submitButtonArea"},[a("a",[a("input",{staticClass:"rewardButton chatEnd",class:{disable:t.isProcessing||!t.canPostComment},attrs:{type:"button",value:"チャットを終了する"},on:{click:function(e){t.closeChat()}}})])]),t._v(" "),a("no-ssr",[a("infinite-loading",{on:{infinite:t.infiniteHandlerComments}},[a("span",{attrs:{slot:"no-more"},slot:"no-more"}),t._v(" "),a("span",{attrs:{slot:"no-results"},slot:"no-results"})])],1),t._v(" "),a("div",{staticClass:"fixedBottom"},[a("div",{staticClass:"messageEntry"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{name:"discription",rows:"4",cols:"30",placeholder:"メッセージ",disabled:!t.canPostComment},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),t._v(" "),a("input",{staticClass:"submitButton",class:{disable:t.isProcessing||!t.canPostComment},attrs:{type:"button",value:"送信する"},on:{click:function(e){t.addComment(t.message)}}})])])],2)]),t._v(" "),t.showModalDialog?a("ModalDialog",{attrs:{messages:t.dialogMessage,imageUrl:t.dialogImageUrl},on:{close:function(e){t.closeModalDialog()}}}):t._e()],1)};n._withStripped=!0;var r,o=a(4),s=a(54),i=a(230),c=a(241),l=a(231),u=a(235),p=a.n(u),m=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),d=function(t,e,a,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,a,n);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(s=(o<3?r(s):o>3?r(e,a,s):r(e,a))||s);return o>3&&s&&Object.defineProperty(e,a,s),s},f=function(t,e,a,n){return new(a||(a=Promise))(function(r,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function i(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?r(t.value):new a(function(e){e(t.value)}).then(s,i)}c((n=n.apply(t,e||[])).next())})},h=function(t,e){var a,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};o.Vue.directive("linkified",p.a);var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isProcessing=!1,e.message=null,e.offsetJoins=s.a.API_PARAM.LIMIT_DEFAULT,e.offsetComments=s.a.API_PARAM.LIMIT_DEFAULT,e.showModalDialog=!1,e.canPostComment=!1,e}return m(e,t),e.prototype.asyncData=function(t){var e=t.app,a=t.store,n=t.route,r=t.redirect,o=t.error;return f(this,void 0,void 0,function(){var t,c,l,u,p,m,d,f;return h(this,function(h){switch(h.label){case 0:return t=new i.a,c="",l=!1,[4,e.$axios.$get(s.a.API_URL.REWARD+"/"+n.params.id).catch(function(e){t.putError(e.response.status)})];case 1:return u=h.sent(),[4,e.$axios.$get(s.a.API_URL.REWARD_COMMENTS.replace("{reward_id}",n.params.id).replace("{owner_name}",n.params.name),{params:{offset:s.a.API_PARAM.OFFSET_DEFAULT,limit:s.a.API_PARAM.LIMIT_DEFAULT}}).catch(function(e){t.putError(e.response.status)})];case 2:return p=h.sent(),[4,e.$axios.$get(s.a.API_URL.REWARD_OWNERS.replace("{reward_id}",n.params.id)+"/"+n.params.name).catch(function(e){t.putError(e.response.status)})];case 3:return m=h.sent(),[4,t.procError(a,n,r,o)];case 4:return h.sent(),d=!1,u.account.accountName===a.state.myProfile.accountName&&(d=!0),c=1===u.publishStatus?"公開中":0===u.createStatus?"作成中":"非公開",l=m.canPostComment||!1,f=s.a.POINT.WIP,[2,{reward:u,isCreater:d,pointName:f,rewardStatsName:c,rewardComments:p,canPostComment:l,dialogImageUrl:s.a.TemplateImg.DIALOG_IMG_URL}]}})})},e.prototype.addComment=function(t){return f(this,void 0,void 0,function(){var e,a,n=this;return h(this,function(r){switch(r.label){case 0:return this.isProcessing||!this.canPostComment?[2]:(this.isProcessing=!0,[4,this.$msalWishHub.silentLogin()]);case 1:return e=r.sent(),[4,this.$store.dispatch("addAccessToken",e)];case 2:return r.sent(),a=new FormData,t?(a.append("RewardId",this.$route.params.id),a.append("OwnerName",this.$route.params.name),a.append("Comment",t),[4,this.$axios.post(s.a.API_URL.REWARD_COMMENTS.replace("{reward_id}",this.$route.params.id).replace("{owner_name}",this.$route.params.name),a).then(function(){n.refreshComment(),n.message=null}).catch(function(t){400===t.response.status?n.openModalDialog(t.response.data.BadRequest):401===t.response.status?(n.openModalDialog(s.a.MESSAGE.ERR_401),n.$store.dispatch("logout")):n.openModalDialog(s.a.MESSAGE.ERR_ELSE)})]):[3,4];case 3:r.sent(),r.label=4;case 4:return this.isProcessing=!1,[2]}})})},e.prototype.closeChat=function(){return f(this,void 0,void 0,function(){var t,e=this;return h(this,function(a){switch(a.label){case 0:return this.isProcessing||!this.canPostComment?[2]:(this.isProcessing=!0,[4,this.$msalWishHub.silentLogin()]);case 1:return t=a.sent(),[4,this.$store.dispatch("addAccessToken",t)];case 2:return a.sent(),[4,this.$axios.post(s.a.API_URL.REWARD_COMMENTS_CLOSE.replace("{reward_id}",this.$route.params.id).replace("{own_name}",this.$route.params.name)).then(function(){e.refreshComment(),e.message=null}).catch(function(t){400===t.response.status?e.openModalDialog(t.response.data.BadRequest):401===t.response.status?(e.openModalDialog(s.a.MESSAGE.ERR_401),e.$store.dispatch("logout")):e.openModalDialog(s.a.MESSAGE.ERR_ELSE)})];case 3:return a.sent(),this.isProcessing=!1,[2]}})})},e.prototype.refreshComment=function(){var t=this;this.$axios.get(s.a.API_URL.REWARD_COMMENTS.replace("{reward_id}",this.$route.params.id).replace("{owner_name}",this.$route.params.name),{params:{offset:s.a.API_PARAM.OFFSET_DEFAULT,limit:s.a.API_PARAM.LIMIT_DEFAULT}}).then(function(e){t.rewardComments=e.data,t.$axios.get(s.a.API_URL.REWARD_OWNERS.replace("{reward_id}",t.$route.params.id)+"/"+t.$route.params.name).then(function(e){var a=e.data;t.canPostComment=a.canPostComment||!1})}).catch(function(t){console.log(t)})},e.prototype.openModalDialog=function(t){this.dialogMessage=t,this.showModalDialog=!0},e.prototype.closeModalDialog=function(){this.showModalDialog=!1},e.prototype.infiniteHandlerComments=function(t){var e=this;this.$axios.get(s.a.API_URL.REWARD_COMMENTS.replace("{reward_id}",this.$route.params.id).replace("{owner_name}",this.$route.params.name),{params:{offset:this.offsetComments,limit:s.a.API_PARAM.LIMIT_DEFAULT}}).then(function(a){var n;a.data.length?(e.offsetComments+=s.a.API_PARAM.LIMIT_DEFAULT,(n=e.rewardComments).push.apply(n,a.data),t.loaded()):t.complete()}).catch(function(e){t.complete()})},e=d([Object(o.Component)({components:{CardUser:c.a,ModalDialog:l.a}})],e)}(o.Vue),_=a(6),g=Object(_.a)(v,n,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this._v("リワード交換者との1対1でメッセージのやりとりができます。"),e("br"),this._v("\n                        個人情報のやりとりが発生する場合には、取り扱いに十分ご注意ください。"),e("br"),this._v("\n                        チャット終了後、チャットを終了するボタンを押してください。"),e("br"),this._v(" "),e("p",{staticClass:"caution"},[this._v("チャットを終了するボタンを押すとメッセージのやりとりはできなくなりますが、履歴が消えることはありません")])])}],!1,null,null,null);e.default=g.exports}}]);